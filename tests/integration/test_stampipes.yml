- name: test_flag_qc_fail_improper_pair_and_nonnuclear_bam_reads
  tags:
    - integration
  command: >-
      tests/caper_run.sh \
      tests/integration/wdl/test_flag_qc_fail_improper_pair_and_nonnuclear_bam_reads.wdl \
      tests/integration/json/test_flag_qc_fail_improper_pair_and_nonnuclear_bam_reads.json
  stdout:
    contains:
      - "python3"
      - "filter_reads.py"
      - "sorted.bam"
      - "chr22.fa.nuclear.txt"
      - "flagged.bam"
  files:
      - path: "test-output/flagged.bam"

- name: test_get_bamcounts 
  tags:
    - integration
  command: >-
    tests/caper_run.sh \
    tests/integration/wdl/test_get_bamcounts.wdl \
    tests/integration/json/test_get_bamcounts.json
  stdout:
    contains:
      - "python3 $(which bamcounts.py)"
      - "merged.bam"
      - "tagcounts.txt"
  files:
    - path: "test-output/tagcounts.txt"
      md5sum: adb348eedf1373493f7eec75a85dec7f
